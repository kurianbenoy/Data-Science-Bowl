from fastai.core import *

Path.read_csv = lambda o: pd.read_csv(o)
input_path = Path("../input/")
pd.options.display.max_columns = 200
pd.options.display.max_rows = 200
print(input_path.ls())
## Read data
sample_subdf = (input_path/'sample_submission.csv').read_csv()
specs_df = (input_path/"specs.csv").read_csv()
train_df = (input_path/"train.csv").read_csv()
train_labels_df = (input_path/"train_labels.csv").read_csv()
test_df = (input_path/"test.csv").read_csv()

train_with_features_part1 = pd.read_feather("../input/dsbowl2019-feng-part1/train_with_features_part1.fth")
train_with_features_part1.shape, test_df.shape, train_labels_df.shape
train_with_features_part1.head()
test_df.head()

# there shouldn't be any common installation ids between test and train 
assert set(train_df.installation_id).intersection(set(test_df.installation_id)) == set()

from fastai.tabular import *
import types

stats = ["median","mean","sum","min","max"]
UNIQUE_COL_VALS = pickle.load(open("../input/dsbowl2019-feng-part1/UNIQUE_COL_VALS.pkl", "rb"))
list(UNIQUE_COL_VALS.__dict__.keys())

# add accuracy_group unique vals
UNIQUE_COL_VALS.__dict__['accuracy_groups'] = np.unique(train_with_features_part1.accuracy_group)
UNIQUE_COL_VALS.accuracy_groups
pickle.dump(UNIQUE_COL_VALS, open( "UNIQUE_COL_VALS.pkl", "wb" ))






